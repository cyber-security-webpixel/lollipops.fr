/*
 v2.0.1653480000
*/
(function(d,l){var m=d.console&&d.console.log?d.console:{log:function(){}};if(d.hasOwnProperty("KWKUniJS"))return m.log("KWKUniJS still loaded"),!1;var e={PROG:"",PTAG_BASE_URL:"img.metaffiliation.com/u/",KWK_DEBUG:"kwkdebug",KWK_COOKIE_CMP_WAIT:"kwkcmpwait",UNIV_COOKIE_NAME:"kwku",UNIV_LS_NAME:"kwkuls",SDKJS_FILENAME:"script.js",CDN_HOST:"",TRK_ARG_UNIV:"kwkuniv",DEFAULT_COOKIE_DAYS:"30",KWK_ONETRUST:"C0003",CONSENT_WAIT_MS:"1000",CONSENT_LOADED:!1,CONSENT_ARGS:{gdpr:null,gdpr_kwk:null,gdpr_consent:null}};
var p=function(){};p.prototype={encode:d.encodeURIComponent||d.escape,isDefined:function(a){return void 0!==a&&null!==a},isFunction:function(a){return"function"===typeof a},isString:function(a){return"string"===typeof a},isObject:function(a){return null!==a&&"object"===typeof a},isNumber:function(a){return"number"===typeof a||!isNaN(a)&&"string"===typeof a&&0<a.length},isArray:function(a){return a.constructor===Array},printCurrentDate:function(){return(new Date).toLocaleString()},stringify:function(a){if(!this.isObject(a)||
null===a)return"";if(this.isObject(d.JSON)&&this.isFunction(d.JSON.stringify))return d.JSON.stringify(a);var b=[];var c="";for(b in a){var f=a[b];this.isString(f)?f='"'+f+'"':this.isObject(f)&&null!==f&&(f=this.stringify(f));c+='"'+b+'":'+f}return"{"+c+"}"},fetchParamFromURI:function(a,b){b=void 0===b?null:b;var c;b||(b=d.location.href);a=a.replace(/[\[\]]/g,"\\$&");return(c=(new RegExp("[?&]"+a+"(=([^&#?]*)|&|#|$)")).exec(b))?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null},fetchProtocol:function(){var a;
var b=d.location.protocol;if("https:"!==b){var c=new RegExp("/^(http:|https:)"+e.CDN_HOST+"/"+e.SDKJS_FILENAME+"$/");var f=d.document.getElementsByTagName("script");for(a=0;a<f.length;a++)if(b=c.exec(f[a].src),this.isObject(b))return b[1]}return"https:"},isRemote:function(){var a;var b=new RegExp("^(http|https)://"+e.CDN_HOST+"/v/js/na/na/u/([\\w\\d]{10}).js$");var c=d.document.getElementsByTagName("script");for(a=0;a<c.length;a++)if(b.test(c[a].src))return!0;return!1},sendRequest:function(a,b,c,
f,k,h,t){try{var g=d.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");"GET"===a.toUpperCase()&&0<c.length&&(b+="?"+c);g.open(a,b,!0);this.tools.isObject(f)&&Object.keys(f).map(function(n){g[n]=f[n]});g.onreadystatechange=function(){3<g.readyState&&(200===parseInt(g.status)||204===parseInt(g.status)?k(g):h(g))};"POST"===a.toUpperCase()&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.setRequestHeader("X-Requested-With","XMLHttpRequest");g.setRequestHeader("X-KWKunijs-Version",
(this.tools.isRemote()?"r":"")+"v2.0.1653480000");t&&g.setRequestHeader("X-KWKunijs-Debug",1);g.send(c)}catch(n){return m.log(n),!1}return g},createPixel:function(a){a+=(a.split("?")[1]?"&":"?")+"kwkujs=1&kwkujsv="+(this.tools.isRemote()?"r":"")+encodeURIComponent("v2.0.1653480000");var b=d.document.createElement("img");b.setAttribute("src",a);b.setAttribute("width","1px");b.setAttribute("height","1px");d.document.body.appendChild(b);this.debug('trkpix "'+a+'" appended to DOM')},documentReady:function(a){"loading"!=
l.readyState?a():l.addEventListener?l.addEventListener("DOMContentLoaded",a):a()},getDeviceType:function(){var a=navigator.userAgent.toLowerCase();return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(a)?"t":/mobile|ip(hone|od)|android|blackberry|iemobile|kindle|silk-accelerated|(hpw|web)os|opera m(obi|ini)/.test(a)?"m":"d"}};"function"!==typeof Array.prototype.push&&(Array.prototype.push=function(a){this[this.length]=a;return this.length});var q=function(){};q.prototype={setCookie:function(a,
b,c){c=void 0===c?60:c;isNaN(c)&&(c=e.DEFAULT_COOKIE_DAYS);if(!this.tools.isDefined(a)||!this.tools.isDefined(b)||isNaN(c))return!1;var f=new Date;f.setTime(f.getTime()+864E5*c);d.document.cookie=a+"="+b+"; SameSite=None; Secure; expires="+f.toUTCString()+"; path=/";this.debug('store cookie : "'+a+"="+b+"; expires="+f.toUTCString()+'; path=/"');return!0},getCookie:function(a){var b=d.document.cookie.split(";");var c=a+"=";for(a=0;a<b.length;a++){var f=b[a];var k=f.indexOf(c);if(-1!==k)return f.substring(k+
c.length)}return null},isLSReady:function(){try{return d.localStorage.setItem("__storage_test__","__storage_test__"),d.localStorage.removeItem("__storage_test__"),!0}catch(a){return a instanceof DOMException&&(22===a.code||1014===a.code||"QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&d.localStorage&&0!==d.localStorage.length}},setLSData:function(a,b,c){c=void 0===c?60:c;isNaN(c)&&(c=e.DEFAULT_COOKIE_DAYS);var f=(new Date).getTime();c=(new Date(f+864E5*c)).getTime();try{return d.localStorage.setItem(a,
b),d.localStorage.setItem(a+"t",c),this.debug("store "+a+"="+b+" and "+a+"t="+c+" in localstorage"),!0}catch(k){this.debug("unable to access localstorage",k)}},getLSData:function(a){if(this.isLSReady())return[d.localStorage.getItem(a),parseInt(d.localStorage.getItem(a+"t"))]}};var r=function(){};r.prototype={tools:new p,storage:new q,cmpWait:d.hasOwnProperty("KWKcmpWait")&&0<d.KWKcmpWait?parseInt(d.KWKcmpWait):parseInt(e.CONSENT_WAIT_MS),isEnvDebug:function(){"undefined"===typeof this.KWKDebug&&(this.KWKDebugLevel=
parseInt(this.storage.getCookie(e.KWK_DEBUG)),this.KWKDebug=0<Math.abs(this.KWKDebugLevel));return this.KWKDebug},debugDoAction:function(){return!this.isEnvDebug()||this.isEnvDebug()&&-1!==this.KWKDebugLevel},debug:function(a,b){this.isEnvDebug()&&(m.log("KWK-UNIJS-SHOPIFY-DEBUG v2.0.1653480000 l"+this.KWKDebugLevel+" - "+this.tools.printCurrentDate()+" : "+a),this.tools.isDefined(b)&&m.log(b))},setVar:function(a,b){e[a]=b;return this},dumpVars:function(){this.debug(e)},buildPtagUrl:function(a,b){return this.tools.fetchProtocol()+
"//"+e.PTAG_BASE_URL+a%41+"/p"+a+(this.tools.isDefined(b)?b:"")+".js"},watch:function(){this.isEnvDebug()&&this.debug("uniJS "+(this.tools.isRemote()?"r":"")+"v2.0.1653480000");this.debug("start watching for "+e.TRK_ARG_UNIV);var a=this.tools.fetchParamFromURI(e.TRK_ARG_UNIV);this.tools.isDefined(a)?(this.debug(e.TRK_ARG_UNIV+' catched with value "'+a+'" from "'+d.location.href+'"'),this.debugDoAction()&&(this.storage.setCookie.call(this,e.UNIV_COOKIE_NAME,a)&&this.debug(e.TRK_ARG_UNIV+" stored in cookie "+
e.UNIV_COOKIE_NAME),this.storage.setLSData.call(this,e.UNIV_LS_NAME,a)&&this.debug(e.TRK_ARG_UNIV+" stored in localstorage "+e.UNIV_LS_NAME))):this.debug("no "+e.TRK_ARG_UNIV+" catched")},ptag:function(a){this.tools.isDefined(a)&&this.tools.isDefined(Object.keys(a))&&0<Object.keys(a).length&&(this.debug("set following args in window.ptag_params :",a),d.ptag_params=a);a={};a=this.tools.isString(a)?JSON.parse(a):a;this.tools.isArray(a)&&0!=a.length?this.debug(a.length+" progs loaded from setup : "+
a):(a=[e.PROG],this.debug("init prog list from default prog "+e.PROG));this.injectPtag.call(this,a);return!0},injectPtag:function(a){var b;for(b=0;b<a.length;b++){var c=this.buildPtagUrl.call(this,a[b]);if(!this.tools.isDefined(c)||0===c.length){this.debug("Unable to build PTag url for p"+a[b]);break}if(this.debugDoAction()){var f=d.document.createElement("script");f.src=c;d.document.body.appendChild(f);this.debug('Ptag url "'+c+'" appended to DOM')}else this.debug('SHOULD append Ptag url "'+c+'" to current page.')}},
IABConsentCheck:function(){try{__tcfapi("addEventListener",2,function(a,b){b?(this.debug("IAB cmp callback successfully triggered with status "+a.eventStatus+" and Kwanko consent "+("undefined"!==typeof a.vendor.consents&&a.vendor.consents[702]?a.vendor.consents[702]:"na")),2==this.KWKDebugLevel&&this.debug("Dumping IAB tcData object :",a),e.CONSENT_ARGS.gdpr="undefined"===typeof a.gdprApplies?"2":a.gdprApplies?"1":"0",e.CONSENT_ARGS.gdpr_kwk="undefined"===typeof a.vendor.consents||"undefined"===
typeof a.vendor.consents[702]?"2":a.vendor.consents[702]?"1":"0",e.CONSENT_ARGS.gdpr_consent="string"===typeof a.tcString&&0<a.tcString.length?"iabtcfv2_"+a.tcString:"",e.CONSENT_LOADED=!0,this.debug("GDPR params loaded from IAB cmp: ",e.CONSENT_ARGS),__tcfapi("removeEventListener",2,function(c){},a.listenerId)):b||this.debug("tcf API failed to fetch consent")}.bind(this))}catch(a){this.debug("exception catched from CMP provider, unable to fetch consent",a)}},AxeptioConsentCheck:function(){try{d._axcb=
d._axcb||[],d._axcb.push(function(a){a.on("cookies:complete",function(b){this.debug("Axeptio cmp callback successfully triggered.");2==this.KWKDebugLevel&&this.debug("Dumping Axeptio SDK object :",b);if("object"===typeof b&&b.hasOwnProperty("kwanko")){var c={id:a.settings.clientId,tsnow:Date.now(),publishedAt:a.config.publishedAt,vendors:b};e.CONSENT_ARGS.gdpr="1";e.CONSENT_ARGS.gdpr_kwk=!0===b.kwanko?"1":!1===b.kwanko?"0":"2";e.CONSENT_ARGS.gdpr_consent="axeptio_"+btoa(JSON.stringify(c));e.CONSENT_LOADED=
!0;this.debug("GDPR params loaded from Axeptio cmp : ",e.CONSENT_ARGS)}}.bind(this),{replay:!0,once:!0})}.bind(this))}catch(a){this.debug("exception catched from Axeptio CMP, unable to fetch consent",a)}},OnetrustConsentCheck:function(){try{var a="string"==typeof d.OnetrustActiveGroups?OnetrustActiveGroups.split(",").map(function(h){return"string"==typeof h?h.trim():h}).filter(function(h){return h}):[];var b=e.KWK_ONETRUST.split(",").filter(function(h){return h})||[];var c;var f=(null==(c=l.cookie.match("(^|;)\\s*OptanonConsent\\s*=\\s*([^;]+)"))?
void 0:c.pop())||"";var k=b.filter(function(h){return a.includes(h)}).length==b.length&&0<b.length?"1":"0";this.debug("Onetrust non IAB cmp callback successfully triggered.");e.CONSENT_ARGS.gdpr="1";e.CONSENT_ARGS.gdpr_kwk=k;e.CONSENT_ARGS.gdpr_consent=0<f.length?"onetrust_"+btoa(f):"onetrust_"+btoa(Date.now()+"_"+a.join("_"));e.CONSENT_LOADED=!0;2==this.KWKDebugLevel&&(this.debug("Dumping Onetrust categories consent :"+a.join(",")),this.debug("Dumping Onetrust expected categories consent :"+b.join(",")),
this.debug("Dumping Onetrust consent string fetched from OptanonConsent cookie :"+f));this.debug("GDPR params loaded from Onetrust non IAB cmp : "+JSON.stringify(e.CONSENT_ARGS))}catch(h){this.debug("exception catched from OneTrust CMP, unable to fetch consent",h)}},getUniv:function(){var a=this.storage.getCookie(e.UNIV_COOKIE_NAME);if(!this.tools.isDefined(a)||0>=a.length)a=this.storage.getLSData(e.UNIV_LS_NAME+e.TRK_ARG_UNIV)[0];return a},iabCmpReady:function(){return"function"===typeof d.__tcfapi},
axeptioCmpReady:function(){return"object"===typeof d.axeptioSDK},onetrustNonIabCmpReady:function(){return"object"===typeof d.OneTrust&&"undefined"===typeof d.__tcfapi},cmpDetected:function(){return this.iabCmpReady()?"IAB cmp detected !":this.axeptioCmpReady()?"Axeptio cmp detected !":this.onetrustNonIabCmpReady()?"OneTrust non IAB cmp detected !":"no cmp detected."}};d.KWKUniJS=new r;d.KWKUniJS.watch()})(window,document);